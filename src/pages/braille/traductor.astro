---
import { ClientRouter, fade, slide } from "astro:transitions";
import "../../style/base.css";

import CustomLetter from "../../components/braille/custom-letter.astro";
import BrailleTimeline from "../../components/braille/time-line.jsx";

import LogoCaed from "../../components/logos/logo-caed.astro";
import LogoCbtis from "../../components/logos/logo-cbtis.astro";
import IconLeftArrow from "../../style/icon-left-arrow.astro";

import LocalVersion from "../../utils/localVersion";
import Loader from "../../components/loaders/loading-2.astro";

const handleLetterChange = (index: number) => {
    console.log(`Letra cambiada a índice: ${index}`);
    // Aquí tu lógica adicional
};
export const prerender = false; // Hace que la página se renderice en el servidor dinámicamente

const url = new URL(Astro.url);
const word = url.searchParams.get("word") || ""; // "xd" es el valor por defecto si no hay palabra

const letterArray = Array.from(word);
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Asistente de braille</title>
        <ClientRouter />
    </head>
    <body
        class="bg-gradient-generic flex flex-col justify-evenly items-center h-screen"
    >
        <Loader />
        <nav class="flex justify-between items-center py-3 w-5/6 h-1/5">
            <a href="https://cbtis212.online/" class="h-full">
                <LogoCbtis size="100%" color="#0B3441" />
            </a>
            <div class="flex justify-beetween w-3/5 gap-x-10 h-full">
                <a
                    href="/braille"
                    class="flex justify-center items-center aspect-square bg-[#edfefe] p-[10px] rounded-[25px]"
                    aria-label="Regresar al inicio"
                    title="Volver al inicio"
                >
                    <span class="ml-[25%]">
                        <IconLeftArrow size={"100%"} color="#083441" />
                    </span>
                </a>

                <div class="flex justify-center w-full h-full">
                    
                </div>
            </div>
            <a href="https://caed.sep.gob.mx/" class="h-full">
                <LogoCaed size="100%" color="#0B3441" />
            </a>
        </nav>
        <main
            class="bg-[#EDFEFE80] h-5/6 w-5/6 max-h-[70%] rounded-[12.5px] grid grid-rows-3"
        >
            <section
                class="row-span-2 flex gap-5 overflow-x-auto w-full pb-2 items-center px-10 scrollbar-hide"
                id="idTemporal"
            >
                <div
                    class="flex items-center gap-10 min-w-max"
                    id="brailleContainer"
                >
                    {
                        letterArray.map((letter: string) => {
                            return <CustomLetter letter={letter} />;
                        })
                    }
                </div>
            </section>

            <section
                class="w-full flex items-center justify-center"
                id="timeline-container"
            >
                <!-- Aqui va el timeline -->
                {
                    (
                        <BrailleTimeline
                            letters={word}
                            currentIndex={0}
                            onLetterChange={handleLetterChange}
                            client:load
                        />
                    )
                }
            </section>
        </main>
        <footer class="text-center">
            <span
                class="text-center text-lg text-[#FFFFFF] font-[600] c-placeholder-text"
            >
                Versión {LocalVersion}
                <br /> Designed by DevSpark
            </span>
        </footer>
    </body>

</html>
